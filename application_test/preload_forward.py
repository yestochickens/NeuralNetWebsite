# without gardenpy imports

def main(a0=None):
    import ast
    import os

    import numpy as np

    def load_params(root):
        weights = []
        biases = []
        with open(os.path.join(root, 'weights.txt'), 'r') as f:
            for line in f:
                weights.append(np.array(ast.literal_eval(line)))
        with open(os.path.join(root, 'biases.txt'), 'r') as f:
            for line in f:
                biases.append(np.array(ast.literal_eval(line)))
        return weights, biases

    def lrelu(x):
        return np.maximum(0.1 * x, x)

    def softmax(x):
        return np.exp(x) / np.sum(np.exp(x))

    w, b = load_params(os.path.dirname(__file__))

    print(w[0].shape)

    a1 = lrelu(np.array([a0]) @ w[0] + b[0])
    a2 = lrelu(a1 @ w[1] + b[1])
    a3 = lrelu(a2 @ w[2] + b[2])

    return {'norm': a3, 'pred': np.argmax(a3), 'prob': softmax(a3)}


if __name__ == '__main__':
    # todo: set input image here
    import numpy as np
    image = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.027450980392156862,0.23137254901960785,0.23137254901960785,0.23529411764705882,0.23529411764705882,0.23137254901960785,0.23137254901960785,0.23529411764705882,0.23529411764705882,0.22745098039215686,0.23137254901960785,0.23529411764705882,0.23137254901960785,0.1450980392156863,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.34509803921568627,0.7176470588235294,0.7176470588235294,0.7333333333333333,0.7333333333333333,0.7254901960784313,0.7176470588235294,0.7333333333333333,0.7294117647058823,0.7137254901960784,0.7294117647058823,0.7294117647058823,0.7176470588235294,0.5647058823529412,0.1411764705882353,0,0,0,0,0,0,0,0,0,0,0,0,0,0.3568627450980392,0.7450980392156863,0.7450980392156863,0.7607843137254902,0.7607843137254902,0.7529411764705882,0.7450980392156863,0.7647058823529411,0.7568627450980392,0.7411764705882353,0.7529411764705882,0.7568627450980392,0.7764705882352941,0.7254901960784313,0.2235294117647059,0,0,0,0,0,0,0,0,0,0,0,0,0,0.050980392156862744,0.25882352941176473,0.25882352941176473,0.2627450980392157,0.2627450980392157,0.25882352941176473,0.25882352941176473,0.2627450980392157,0.2627450980392157,0.2549019607843137,0.2627450980392157,0.49411764705882355,0.9019607843137255,0.5725490196078431,0.11372549019607843,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.23529411764705882,0.6901960784313725,0.8235294117647058,0.3764705882352941,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.4235294117647059,0.8588235294117647,0.6392156862745098,0.1803921568627451,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16862745098039217,0.6196078431372549,0.8823529411764706,0.45098039215686275,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.3764705882352941,0.8235294117647058,0.7019607843137254,0.25098039215686274,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.13725490196078433,0.5843137254901961,0.9490196078431372,0.5019607843137255,0.047058823529411764,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.35294117647058826,0.8,0.7450980392156863,0.29411764705882354,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12941176470588237,0.5686274509803921,0.9686274509803922,0.5294117647058824,0.0784313725490196,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.37254901960784315,0.807843137254902,0.7490196078431373,0.3137254901960784,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.17647058823529413,0.615686274509804,0.9411764705882353,0.5098039215686274,0.07058823529411765,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.027450980392156862,0.45098039215686275,0.8666666666666667,0.7019607843137254,0.26666666666666666,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29411764705882354,0.7058823529411765,0.8235294117647058,0.42745098039215684,0.011764705882352941,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1568627450980392,0.5568627450980392,0.9098039215686274,0.5843137254901961,0.16862745098039217,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.054901960784313725,0.43529411764705883,0.8431372549019608,0.7333333333333333,0.3215686274509804,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.011764705882352941,0.38823529411764707,0.7529411764705882,0.8627450980392157,0.4470588235294118,0.03137254901960784,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.09019607843137255,0.4,0.7176470588235294,0.9019607843137255,0.5176470588235295,0.1607843137254902,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.3333333333333333,0.796078431372549,0.9058823529411765,0.5725490196078431,0.19607843137254902,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2549019607843137,0.6078431372549019,0.5058823529411764,0.21568627450980393,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12549019607843137,0.07058823529411765,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
    image = np.array(image)
    print(main(image))
