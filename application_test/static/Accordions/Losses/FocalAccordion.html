<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<script>
    $("#FocalDerivativeAccordion").load("static/Accordions/Losses/FocalDerivativeAccordion.html");
</script>
<p>
    <strong>Focal</strong> loss is a loss also used for binary classification, much like <strong>Cross-entropy</strong>; however, focal loss allows for focusing on harder to predict labels, allowing proper training on <strong>unbalanced</strong> datasets by giving more weight to the less common datapoints, allowing them to not be outweighed. Due to its use in unbalanced datasets, its often used in medical AI.
</p>
<div class="accordion-item">
    <h2 class="accordion-header" id="headingFocalHyperparameters">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalHyperparameters" aria-expanded="true" aria-controls="collapseFocalHyperparameters">
            Hyperparameters
        </button>
    </h2>
    <div id="collapseFocalHyperparameters" class="accordion-collapse collapse" aria-labelledby="headingFocalHyperparameters">
        <div class="accordion-body">
            <p>
                <strong>Weight</strong>
                \[\alpha^\mathrm{[s]} = 1\]
                
                <strong>Focusing</strong>
                \[\gamma^\mathrm{[s]} = 2\]
                
                <strong>Epsilon</strong>
                \[\epsilon^\mathrm{[s]} = 1 \times 10^{-8}\]
            </p>
        </div>
    </div>
</div>
<div class="accordion-item">
    <h2 class="accordion-header" id="headingFocalVariables">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalVariables" aria-expanded="true" aria-controls="collapseFocalVariables">
            Variables
        </button>
    </h2>
    <div id="collapseFocalVariables" class="accordion-collapse collapse" aria-labelledby="headingFocalVariables">
        <div class="accordion-body">
            <div class="accordion" id="compactedNotationAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFocalVariablesCompacted">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalVariablesCompacted" aria-expanded="true" aria-controls="collapseFocalVariablesCompacted">
                            Compacted Notation
                        </button>
                    </h2>
                    <div id="collapseFocalVariablesCompacted" class="accordion-collapse collapse" aria-labelledby="headingFocalVariablesCompacted">
                        <div class="accordion-body">
                            <strong>Predicted</strong> 
                            \[\mathbf{\hat{Y}}\]

                            <strong>Expected</strong>
                            \[\mathbf{Y}\]
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFocalVariablesExpanded">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalVariablesExpanded" aria-expanded="true" aria-controls="collapseFocalVariablesExpanded">
                            Expanded Notation
                        </button>
                    </h2>
                    <div id="collapseFocalVariablesExpanded" class="accordion-collapse collapse" aria-labelledby="headingFocalVariablesExpanded">
                        <div class="accordion-body">
                            <strong>Predicted</strong>
                            \[\begin{bmatrix}
                            \widehat{y_0} \\
                            \vdots \\
                            \widehat{y_{n_y}}
                            \end{bmatrix}\]
                            
                            <strong>Expected</strong>
                            
                            \[\begin{bmatrix}
                            y_0 \\
                            \vdots \\
                            y_{n_y}
                            \end{bmatrix}\]
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="accordion-item">
    <h2 class="accordion-header" id="headingFocalFunction">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalFunction" aria-expanded="true" aria-controls="collapseFocalFunction">
            Function
        </button>
    </h2>
    <div id="collapseFocalFunction" class="accordion-collapse collapse" aria-labelledby="headingFocalFunction">
        <div class="accordion-body">
            <div class="accordion" id="compactedNotationAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFocalFunctionCompacted">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalFunctionCompacted" aria-expanded="true" aria-controls="collapseFocalFunctionCompacted">
                            Compacted Notation
                        </button>
                    </h2>
                    <div id="collapseFocalFunctionCompacted" class="accordion-collapse collapse" aria-labelledby="headingFocalFunctionCompacted">
                        <div class="accordion-body">
                            <strong>Equation</strong>
                            \[J \left( \mathbf{\hat{Y}}, \mathbf{Y} \right)
                            =
                            - \sum_{i=1}^{n_y} \left( \alpha \left( y_i - \widehat{y_i} \right)^\gamma \mathrm{ln} \left( \widehat{y_i} + \epsilon \right) \right)\]
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingFocalFunctionExpanded">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalFunctionExpanded" aria-expanded="true" aria-controls="collapseFocalFunctionExpanded">
                            Expanded Notation
                        </button>
                    </h2>
                    <div id="collapseFocalFunctionExpanded" class="accordion-collapse collapse" aria-labelledby="headingFocalFunctionExpanded">
                        <div class="accordion-body">
                            <strong>Equation</strong>
                            \[J \left( \begin{bmatrix}
                            \widehat{y_0} \\
                            \vdots \\
                            \widehat{y_{n_y}}
                            \end{bmatrix},
                            \begin{bmatrix}
                            y_0 \\
                            \vdots \\
                            y_{n_y}
                            \end{bmatrix} \right)
                            =
                            - \sum_{i=1}^{n_y} \left( \alpha \left( y_i - \widehat{y_i} \right)^\gamma \mathrm{ln} \left( \widehat{y_i} + \epsilon \right) \right)\]
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="accordion-item">
    <h2 class="accordion-header" id="headingFocalDerivative">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFocalDerivative" aria-expanded="true" aria-controls="collapseFocalDerivative">
            Derivative
        </button>
    </h2>
    <div id="collapseFocalDerivative" class="accordion-collapse collapse" aria-labelledby="headingFocalDerivative">
        <div class="accordion-body">
            <div id="FocalDerivativeAccordion"></div>
        </div>
    </div>
</div>
