<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<script>
    $("#SGDMethodAccordion").load("static/Accordions/Optimizers/SGDMethodAccordion.html");
</script>
<p>
    <strong>SGD</strong>, short for Stochastic Gradient Descent, is the most straightforward optimization algorithm. It directly descends down the calculated gradient.
    Typically, SGD allows some modifications from raw gradient descent. <strong>Momentum</strong> allows for smoother descent with a better chance to end in a global, rather than local minimum. <strong>Dampening</strong> reduces the current gradient term and allows for more reliance on momentum.
    Additionally, descent can be increased through prediction of momentum terms via the <strong>Nesterov</strong> variant of momentum.
</p>

<div class="accordion-item">
    <h2 class="accordion-header" id="headingSGDHyperparams">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDHyperparams" aria-expanded="true" aria-controls="collapseSGDHyperparams">
            Hyperparameters
        </button>
    </h2>
    <div id="collapseSGDHyperparams" class="accordion-collapse collapse" aria-labelledby="headingSGDHyperparams">
        <div class="accordion-body">
            <p>
                <strong>Learning Rate</strong>
                \[\alpha^\mathrm{[s]} = 1 \times 10^{-3}\]

                <strong>L2 Term </strong>
                \[\lambda^\mathrm{[s]} = 0\]

                <strong>Momentum</strong> 
                \[\mu^\mathrm{[s]} = 0\]

                <strong>Dampening</strong> 
                \[\tau^\mathrm{[s]} = 0\]

                <strong>Nesterov Variant</strong>
                \[nesterov^\mathrm{[s]} = \mathrm{False}\]
            </p>
        </div>
    </div>
</div>

<div class="accordion-item">
    <h2 class="accordion-header" id="headingSGDInitialStates">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDInitialStates" aria-expanded="true" aria-controls="collapseSGDInitialStates">
            Initial States
        </button>
    </h2>
    <div id="collapseSGDInitialStates" class="accordion-collapse collapse" aria-labelledby="headingSGDInitialStates">
        <div class="accordion-body">
            <div class="accordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingSGDInitialStatesCompacted">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDInitialStatesCompacted" aria-expanded="true" aria-controls="collapseSGDInitialStatesCompacted">
                            Compacted Notation
                        </button>
                    </h2>
                    <div id="collapseSGDInitialStatesCompacted" class="accordion-collapse collapse" aria-labelledby="headingSGDInitialStatesCompacted">
                        <div class="accordion-body">
                            <strong>Delta</strong> 
                            \[\mathbf{\Delta_{P_\mathit{0}}^\mathrm{[l]}} = \mathbf{0}_{m \times n}\]
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingSGDInitialStatesExpanded">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDInitialStatesExpanded" aria-expanded="true" aria-controls="collapseSGDInitialStatesExpanded">
                            Expanded Notation
                        </button>
                    </h2>
                    <div id="collapseSGDInitialStatesExpanded" class="accordion-collapse collapse" aria-labelledby="headingSGDInitialStatesExpanded">
                        <div class="accordion-body">
                            <strong>Delta</strong>
                            \[
                            \mathbf{\Delta_{P_\mathit{0}}^\mathrm{[l]}} = 
                            \begin{bmatrix}
                            0 & \cdots & 0 \\
                            \vdots & \ddots & \vdots \\
                            0 & \cdots & 0
                            \end{bmatrix}
                            \]
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="accordion-item">
    <h2 class="accordion-header" id="headingSGDVariables">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDVariables" aria-expanded="true" aria-controls="collapseSGDVariables">
            Variables
        </button>
    </h2>
    <div id="collapseSGDVariables" class="accordion-collapse collapse" aria-labelledby="headingSGDVariables">
        <div class="accordion-body">
            <div class="accordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingSGDVariablesCompacted">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDVariablesCompacted" aria-expanded="true" aria-controls="collapseSGDVariablesCompacted">
                            Compacted Notation
                        </button>
                    </h2>
                    <div id="collapseSGDVariablesCompacted" class="accordion-collapse collapse" aria-labelledby="headingSGDVariablesCompacted">
                        <div class="accordion-body">
                            <strong>Trainable Parameters</strong>
                            \[\mathbf{\Theta_P^\mathrm{[l]}}\]

                            <strong>Gradients</strong>
                            \[\nabla_{\mathbf{\Theta_P^\mathrm{[l]}}}\mathbf{L}\]
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingSGDVariablesExpanded">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDVariablesExpanded" aria-expanded="true" aria-controls="collapseSGDVariablesExpanded">
                            Expanded Notation
                        </button>
                    </h2>
                    <div id="collapseSGDVariablesExpanded" class="accordion-collapse collapse" aria-labelledby="headingSGDVariablesExpanded">
                        <div class="accordion-body">
                            <strong>Trainable Parameters</strong>
                            \[\begin{bmatrix}
                            \theta_{\mathrm{p}_{0, 0}}^\mathrm{[l]} &
                            \cdots &
                            \theta_{\mathrm{p}_{0, n}}^\mathrm{[l]} \\
                            \vdots &
                            \ddots &
                            \vdots \\
                            \theta_{\mathrm{p}_{m, 0}}^\mathrm{[l]} &
                            \cdots &
                            \theta_{\mathrm{p}_{m, n}}^\mathrm{[l]} \\
                            \end{bmatrix}\]
                            
                            <strong>Gradients</strong>
                            \[\begin{bmatrix}
                            \displaystyle \frac{\partial}{\partial \theta^{\mathrm{[l]}}_{\mathrm{p}_{0, 0}}}\mathbf{L} &
                            \cdots &
                            \displaystyle \frac{\partial}{\partial \theta^{\mathrm{[l]}}_{\mathrm{p}_{0, n}}}\mathbf{L} \\
                            \vdots &
                            \ddots &
                            \vdots \\
                            \displaystyle \frac{\partial}{\partial \theta^{\mathrm{[l]}}_{\mathrm{p}_{m, 0}}}\mathbf{L} &
                            \cdots &
                            \displaystyle \frac{\partial}{\partial \theta^{\mathrm{[l]}}_{\mathrm{p}_{m, n}}}\mathbf{L} \\
                            \end{bmatrix}\]
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="accordion-item">
    <h2 class="accordion-header" id="headingSGDMethod">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSGDMethod" aria-expanded="true" aria-controls="collapseSGDMethod">
            Method
        </button>
    </h2>
    <div id="collapseSGDMethod" class="accordion-collapse collapse" aria-labelledby="headingSGDMethod">
        <div class="accordion-body">
            <div id="SGDMethodAccordion"></div>
        </div>
    </div>
</div>
